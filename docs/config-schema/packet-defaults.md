# Packet Defaults ìŠ¤í‚¤ë§ˆ ì‘ì„±ë²•

`homenet_bridge.packet_defaults`ëŠ” ëª¨ë“  ì—”í‹°í‹°ê°€ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” íŒ¨í‚· í”„ë ˆì„ ê·œì¹™ê³¼ ì‹œê°„ ì œì–´ ê°’ì„ ì •ì˜í•©ë‹ˆë‹¤. í—¤ë”/í‘¸í„°, ì²´í¬ì„¬, íƒ€ì„ì•„ì›ƒì„ í•œ ë²ˆì— ì§€ì •í•´ ì¤‘ë³µì„ ì¤„ì´ê³ , ê°œë³„ ì—”í‹°í‹° ë¸”ë¡ì—ì„œ í•„ìš”í•  ë•Œë§Œ ì˜¤ë²„ë¼ì´ë“œí•©ë‹ˆë‹¤.

## í•„ë“œ ëª©ë¡
- `rx_header` / `tx_header`: ìˆ˜ì‹ Â·ì†¡ì‹  íŒ¨í‚· ì•ë¶€ë¶„ ì‹ë³„ ë°”ì´íŠ¸ ë°°ì—´.
- `rx_footer` / `tx_footer`: íŒ¨í‚· ì¢…ë£Œ ì‹œê·¸ë„.
- `rx_checksum` / `tx_checksum`: ê¸°ë³¸ 1ë°”ì´íŠ¸ ì²´í¬ì„¬ ê³„ì‚°ê¸° (ì•Œê³ ë¦¬ì¦˜ ì´ë¦„ ë¬¸ìì—´ ë˜ëŠ” CEL í‘œí˜„ì‹).
- `rx_checksum2` / `tx_checksum2`: ì´ì¤‘(2ë°”ì´íŠ¸) ì²´í¬ì„¬ ê³„ì‚°ê¸° (ì•Œê³ ë¦¬ì¦˜ ì´ë¦„ ë¬¸ìì—´ ë˜ëŠ” CEL í‘œí˜„ì‹).
- `rx_length`: ê³ ì • ê¸¸ì´ íŒ¨í‚·ì¼ ë•Œ ì „ì²´ ê¸¸ì´ë¥¼ ëª…ì‹œ.
- `tx_delay`: ì¬ì „ì†¡ ê°„ê²© ëŒ€ê¸° ì‹œê°„ (ms).
- `tx_retry_cnt`: ëª…ë ¹ ì „ì†¡ ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ íšŸìˆ˜.
- `tx_timeout`: ëª…ë ¹ íŒ¨í‚· ì „ì†¡ í›„ ì‘ë‹µ ëŒ€ê¸° ì‹œê°„ (ms).
- `rx_timeout`: ìƒíƒœ íŒ¨í‚· ìˆ˜ì‹  ëŒ€ê¸° ì‹œê°„ (ms).

## ì „ì†¡ ì œì–´ íŒŒë¼ë¯¸í„° ìƒì„¸ (Transmission Control Parameters)

ëª…ë ¹ íŒ¨í‚·ì„ ì „ì†¡í•  ë•Œ `tx_timeout`, `tx_retry_cnt`, `tx_delay`ê°€ ì–´ë–»ê²Œ ìƒí˜¸ì‘ìš©í•˜ëŠ”ì§€ ì„¤ëª…í•©ë‹ˆë‹¤.

1. **tx_timeout (ì‘ë‹µ ëŒ€ê¸° ì‹œê°„)**
   - ëª…ë ¹ íŒ¨í‚·ì„ ì „ì†¡í•œ ì§í›„ë¶€í„° ì‘ë‹µ(ACK íŒ¨í‚· ë˜ëŠ” ìƒíƒœ ë³€ê²½ ì´ë²¤íŠ¸)ì„ ê¸°ë‹¤ë¦¬ëŠ” ìµœëŒ€ ì‹œê°„ì…ë‹ˆë‹¤.
   - ì´ ì‹œê°„ ë‚´ì— ì‘ë‹µì´ ì˜¤ì§€ ì•Šìœ¼ë©´ í•´ë‹¹ ì‹œë„ëŠ” ì‹¤íŒ¨ë¡œ ê°„ì£¼ë©ë‹ˆë‹¤.
   - ê¸°ë³¸ê°’: `2000ms`

2. **tx_retry_cnt (ì¬ì‹œë„ íšŸìˆ˜)**
   - ìµœì´ˆ ì „ì†¡ì´ `tx_timeout`ìœ¼ë¡œ ì¸í•´ ì‹¤íŒ¨í–ˆì„ ë•Œ, ì¶”ê°€ë¡œ ì¬ì‹œë„í•  íšŸìˆ˜ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.
   - ì˜ˆë¥¼ ë“¤ì–´ `tx_retry_cnt: 3`ìœ¼ë¡œ ì„¤ì •í•˜ë©´, ìµœì´ˆ 1íšŒ + ì¬ì‹œë„ 3íšŒ = **ì´ 4íšŒ**ê¹Œì§€ ì „ì†¡ì„ ì‹œë„í•©ë‹ˆë‹¤.
   - ê¸°ë³¸ê°’: `5íšŒ`

3. **tx_delay (ì¬ì „ì†¡ ê°„ê²©)**
   - ì „ì†¡ ì‹¤íŒ¨ê°€ í™•ì •ëœ í›„, ë‹¤ìŒ ì¬ì‹œë„ë¥¼ í•˜ê¸° ì „ê¹Œì§€ ëŒ€ê¸°í•˜ëŠ” ì‹œê°„ì…ë‹ˆë‹¤.
   - ì¦‰, `ì „ì†¡ -> (íƒ€ì„ì•„ì›ƒ) -> ì‹¤íŒ¨ -> [tx_delay ëŒ€ê¸°] -> ì¬ì „ì†¡` ìˆœì„œë¡œ ì§„í–‰ë©ë‹ˆë‹¤.
   - ê¸°ë³¸ê°’: `125ms`

> **ì°¸ê³ **: `tx_delay`ëŠ” ì¬ì „ì†¡ ì‚¬ì´ì˜ ê°„ê²©ì¼ ë¿, ì„œë¡œ ë‹¤ë¥¸ ëª…ë ¹ íŒ¨í‚· ì‚¬ì´ì˜ ìµœì†Œ ê°„ê²©(Inter-frame gap)ì„ ì˜ë¯¸í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.

## ì§€ì›í•˜ëŠ” ì²´í¬ì„¬ ì•Œê³ ë¦¬ì¦˜ (Supported Checksum Algorithms)

íŒ¨í‚· ë¬´ê²°ì„± ê²€ì¦ì„ ìœ„í•œ ì²´í¬ì„¬ ì•Œê³ ë¦¬ì¦˜ì„ ë¬¸ìì—´ë¡œ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ëª©ë¡ì— ì—†ëŠ” ë³µì¡í•œ ë¡œì§ì€ CEL í‘œí˜„ì‹ìœ¼ë¡œ ì§ì ‘ êµ¬í˜„í•´ì•¼ í•©ë‹ˆë‹¤.

> ğŸ“˜ **ìƒì„¸ ê°€ì´ë“œ**: ê° ì•Œê³ ë¦¬ì¦˜ì˜ ì •í™•í•œ ìˆ˜ì‹ê³¼ ë™ì‘ ì›ë¦¬ëŠ” [ì²´í¬ì„¬ ì•Œê³ ë¦¬ì¦˜ ë ˆí¼ëŸ°ìŠ¤](reference/checksum-algorithms.md) ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì„¸ìš”.

### 1ë°”ì´íŠ¸ ì²´í¬ì„¬ (`rx_checksum` / `tx_checksum`)

| ì•Œê³ ë¦¬ì¦˜ (ê°’) | ì„¤ëª… |
| :--- | :--- |
| `add` | í—¤ë”ë¥¼ í¬í•¨í•œ ëª¨ë“  ë°”ì´íŠ¸ì˜ í•© (Sum & 0xFF) |
| `add_no_header` | í—¤ë”ë¥¼ ì œì™¸í•œ ë°ì´í„° ë°”ì´íŠ¸ì˜ í•© (Sum & 0xFF) |
| `xor` | í—¤ë”ë¥¼ í¬í•¨í•œ ëª¨ë“  ë°”ì´íŠ¸ì˜ XOR ì—°ì‚° ê°’ |
| `xor_no_header` | í—¤ë”ë¥¼ ì œì™¸í•œ ë°ì´í„° ë°”ì´íŠ¸ì˜ XOR ì—°ì‚° ê°’ |
| `samsung_rx` | ì‚¼ì„± ì›”íŒ¨ë“œ ìˆ˜ì‹  íŒ¨í‚· ì „ìš© (0xB0 ì´ˆê¸°ê°’ + XOR, ë‹¨ ì²« ë°ì´í„°ê°€ 0x7C ë¯¸ë§Œì´ë©´ XOR 0x80 ì¶”ê°€ ë³´ì •) |
| `samsung_tx` | ì‚¼ì„± ì›”íŒ¨ë“œ ì†¡ì‹  íŒ¨í‚· ì „ìš© (0x00 ì´ˆê¸°ê°’ + XOR + 0x80 ë³´ì •) |
| `none` | ì²´í¬ì„¬ ê²€ì‚¬ë¥¼ í•˜ì§€ ì•ŠìŒ |

### 2ë°”ì´íŠ¸ ì²´í¬ì„¬ (`rx_checksum2` / `tx_checksum2`)

| ì•Œê³ ë¦¬ì¦˜ (ê°’) | ì„¤ëª… |
| :--- | :--- |
| `xor_add` | Ezville ë“±ì—ì„œ ì‚¬ìš©. `[XOR, (ADD+XOR)]` ìˆœì„œë¡œ 2ë°”ì´íŠ¸ ìƒì„± (í—¤ë” í¬í•¨, ADDëŠ” XOR ê²°ê³¼ë¥¼ ë”í•œ ê°’) |

> **ì°¸ê³ **: ì²´í¬ì„¬ í•„ë“œì— ì•Œê³ ë¦¬ì¦˜ ì´ë¦„ ëŒ€ì‹  CEL í‘œí˜„ì‹ì„ ì‘ì„±í•˜ë©´ ì»¤ìŠ¤í…€ ë¡œì§ì„ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> ì˜ˆ: `rx_checksum: "data[0] + data[1]"`

## ê¸°ë³¸ ì˜ˆì œ (ì–‘ë°©í–¥ ë™ì¼ í—¤ë”/í‘¸í„°)
`kocom.homenet_bridge.yaml`ì€ ë™ì¼í•œ í—¤ë”Â·í‘¸í„°ì™€ ë‹¨ìˆœ í•©ì‚° ì²´í¬ì„¬ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

```yaml
homenet_bridge:
  packet_defaults:
    rx_timeout: 10ms
    tx_delay: 50ms
    tx_timeout: 500ms
    tx_retry_cnt: 3
    rx_header: [0xAA, 0x55]
    rx_footer: [0x0D, 0x0D]
    tx_header: [0xAA, 0x55]
    tx_footer: [0x0D, 0x0D]
    rx_checksum: add_no_header
    tx_checksum: add_no_header
```

## ë°©í–¥ë³„ í—¤ë”/ì²´í¬ì„¬ì´ ë‹¤ë¥¸ ì˜ˆì œ
`cvnet.homenet_bridge.yaml`ì²˜ëŸ¼ ìˆ˜ì‹ Â·ì†¡ì‹  í—¤ë”ê°€ ê°™ë”ë¼ë„ í‘¸í„°ì™€ ì²´í¬ì„¬ ë¡œì§ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```yaml
homenet_bridge:
  packet_defaults:
    rx_header: [0xF7]
    rx_footer: [0xAA]
    rx_checksum: add_no_header
    tx_header: [0xF7]
    tx_footer: [0xAA]
    tx_checksum: add_no_header
```

## ì´ì¤‘ ì²´í¬ì„¬ ì˜ˆì œ
`ezville.homenet_bridge.yaml`ì€ XOR+í•©ì‚° ë°©ì‹ì˜ ë³´ì¡° ì²´í¬ì„¬ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ê¸°ë³¸ ì²´í¬ì„¬ì´ ì—†ì„ ë•Œ `rx_checksum`ë¥¼ ìƒëµí•˜ê³  `rx_checksum2`ë§Œ ë‘˜ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.

```yaml
homenet_bridge:
  packet_defaults:
    rx_header: [0xF7]
    tx_header: [0xF7]
    rx_checksum2: xor_add
    tx_checksum2: xor_add
```

## ë¸Œëœë“œë³„ ì»¤ìŠ¤í…€ ê³„ì‚°ê¸° ì˜ˆì œ
`samsung_sds.homenet_bridge.yaml`ì€ ì „ìš© ì²´í¬ì„¬ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ë¦„ë§Œ ë°”ê¾¸ë©´ ë‹¤ë¥¸ ì—”í‹°í‹°ê°€ ìë™ìœ¼ë¡œ ìƒì†í•©ë‹ˆë‹¤.

```yaml
homenet_bridge:
  packet_defaults:
    rx_header: [0xB0]
    rx_checksum: samsung_rx
    tx_checksum: samsung_tx
```

## ì‘ì„± íŒ
1. í—¤ë”/í‘¸í„°ì™€ ì²´í¬ì„¬ ê³„ì‚° ê·œì¹™ì„ ëª¨ë¥´ë©´ ìš°ì„  íŒ¨í‚· ìº¡ì²˜ë¥¼ ì§„í–‰í•œ ë’¤, ë™ì¼í•œ êµ¬ê°„ì„ `state.data`ë¡œ ë§ì¶° ë„£ìœ¼ì„¸ìš”.
2. ì—”í‹°í‹°ë§ˆë‹¤ íŠ¹ì´ ê·œì¹™ì´ ìˆì„ ê²½ìš° í•´ë‹¹ ì—”í‹°í‹° ë¸”ë¡ ì•ˆì— `packet_defaults`ë¥¼ ì¤‘ì²©í•´ ì¼ë¶€ ê°’ë§Œ ë®ì–´ì“°ë©´ ë©ë‹ˆë‹¤.
3. íƒ€ì„ì•„ì›ƒê³¼ ì§€ì—°ì€ ì¥ë¹„ ì‘ë‹µ ì†ë„ì— ë§ì¶° ì¡°ì •í•˜ë˜, ê³¼ë„í•˜ê²Œ ì§§ìœ¼ë©´ ì¬ì „ì†¡ì´ ë°˜ë³µë˜ê³  ê¸¸ë©´ UI ë°˜ì‘ì´ ëŠë ¤ì§‘ë‹ˆë‹¤.
