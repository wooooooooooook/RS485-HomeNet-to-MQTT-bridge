var we=Object.defineProperty;var Ee=(t,e,n)=>e in t?we(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var te=(t,e,n)=>Ee(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const o of u)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function n(u){const o={};return u.integrity&&(o.integrity=u.integrity),u.referrerPolicy&&(o.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?o.credentials="include":u.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(u){if(u.ep)return;u.ep=!0;const o=n(u);fetch(u.href,o)}})();function z(){}function _e(t){return t()}function ie(){return Object.create(null)}function Z(t){t.forEach(_e)}function Be(t){return typeof t=="function"}function ke(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function je(t){return Object.keys(t).length===0}function s(t,e){t.appendChild(e)}function T(t,e,n){t.insertBefore(e,n||null)}function q(t){t.parentNode&&t.parentNode.removeChild(t)}function Ae(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function i(t){return document.createElement(t)}function N(t){return document.createTextNode(t)}function j(){return N(" ")}function De(){return N("")}function Se(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function f(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Le(t){return Array.from(t.childNodes)}function I(t,e){e=""+e,t.data!==e&&(t.data=e)}let Y;function W(t){Y=t}function me(){if(!Y)throw new Error("Function called outside component initialization");return Y}function Pe(t){me().$$.on_mount.push(t)}function Ne(t){me().$$.on_destroy.push(t)}const V=[],ce=[];let X=[];const ae=[],Oe=Promise.resolve();let le=!1;function Fe(){le||(le=!0,Oe.then(ge))}function ue(t){X.push(t)}const ne=new Set;let Q=0;function ge(){if(Q!==0)return;const t=Y;do{try{for(;Q<V.length;){const e=V[Q];Q++,W(e),Re(e.$$)}}catch(e){throw V.length=0,Q=0,e}for(W(null),V.length=0,Q=0;ce.length;)ce.pop()();for(let e=0;e<X.length;e+=1){const n=X[e];ne.has(n)||(ne.add(n),n())}X.length=0}while(V.length);for(;ae.length;)ae.pop()();le=!1,ne.clear(),W(t)}function Re(t){if(t.fragment!==null){t.update(),Z(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ue)}}function Ue(t){const e=[],n=[];X.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),X=e}const Me=new Set;function ve(t,e){t&&t.i&&(Me.delete(t),t.i(e))}function ee(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function He(t,e){t.d(1),e.delete(t.key)}function qe(t,e,n,l,u,o,r,d,C,c,g,k){let y=t.length,v=o.length,w=y;const O={};for(;w--;)O[t[w].key]=w;const D=[],A=new Map,F=new Map,b=[];for(w=v;w--;){const a=k(u,o,w),m=n(a);let h=r.get(m);h?b.push(()=>h.p(a,e)):(h=c(m,a),h.c()),A.set(m,D[w]=h),m in O&&F.set(m,Math.abs(w-O[m]))}const p=new Set,E=new Set;function S(a){ve(a,1),a.m(d,g),r.set(a.key,a),g=a.first,v--}for(;y&&v;){const a=D[v-1],m=t[y-1],h=a.key,R=m.key;a===m?(g=a.first,y--,v--):A.has(R)?!r.has(h)||p.has(h)?S(a):E.has(R)?y--:F.get(h)>F.get(R)?(E.add(h),S(a)):(p.add(R),y--):(C(m,r),y--)}for(;y--;){const a=t[y];A.has(a.key)||C(a,r)}for(;v;)S(D[v-1]);return Z(b),D}function Ie(t,e,n){const{fragment:l,after_update:u}=t.$$;l&&l.m(e,n),ue(()=>{const o=t.$$.on_mount.map(_e).filter(Be);t.$$.on_destroy?t.$$.on_destroy.push(...o):Z(o),t.$$.on_mount=[]}),u.forEach(ue)}function Te(t,e){const n=t.$$;n.fragment!==null&&(Ue(n.after_update),Z(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function $e(t,e){t.$$.dirty[0]===-1&&(V.push(t),Fe(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ze(t,e,n,l,u,o,r=null,d=[-1]){const C=Y;W(t);const c=t.$$={fragment:null,ctx:[],props:o,update:z,not_equal:u,bound:ie(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(C?C.$$.context:[])),callbacks:ie(),dirty:d,skip_bound:!1,root:e.target||C.$$.root};r&&r(c.root);let g=!1;if(c.ctx=n?n(t,e.props||{},(k,y,...v)=>{const w=v.length?v[0]:y;return c.ctx&&u(c.ctx[k],c.ctx[k]=w)&&(!c.skip_bound&&c.bound[k]&&c.bound[k](w),g&&$e(t,k)),y}):[],c.update(),g=!0,Z(c.before_update),c.fragment=l?l(c.ctx):!1,e.target){if(e.hydrate){const k=Le(e.target);c.fragment&&c.fragment.l(k),k.forEach(q)}else c.fragment&&c.fragment.c();e.intro&&ve(t.$$.fragment),Ie(t,e.target,e.anchor),ge()}W(C)}class Je{constructor(){te(this,"$$");te(this,"$$set")}$destroy(){Te(this,1),this.$destroy=z}$on(e,n){if(!Be(n))return z;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const u=l.indexOf(n);u!==-1&&l.splice(u,1)}}$set(e){this.$$set&&!je(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ke="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ke);function fe(t,e,n){const l=t.slice();return l[16]=e[n],l}function de(t,e,n){const l=t.slice();return l[19]=e[n],l[21]=n,l}function Qe(t){let e,n,l,u,o,r=(t[0].serialPath||"입력되지 않음")+"",d,C,c,g,k,y,v=t[0].baudRate+"",w,O,D,A,F,b,p=t[0].mqttUrl+"",E,S,a,m,h=t[0].error&&Ce(t);function R(B,U){return B[3].length===0?Ye:We}let L=R(t),_=L(t);return{c(){e=i("div"),n=i("div"),l=i("span"),l.textContent="Serial Path",u=j(),o=i("strong"),d=N(r),C=j(),c=i("div"),g=i("span"),g.textContent="Baud Rate",k=j(),y=i("strong"),w=N(v),O=j(),D=i("div"),A=i("span"),A.textContent="MQTT URL",F=j(),b=i("strong"),E=N(p),S=j(),h&&h.c(),a=j(),m=i("div"),_.c(),f(l,"class","label svelte-52jy8y"),f(g,"class","label svelte-52jy8y"),f(A,"class","label svelte-52jy8y"),f(e,"class","viewer-meta svelte-52jy8y"),f(m,"class","packet-list svelte-52jy8y")},m(B,U){T(B,e,U),s(e,n),s(n,l),s(n,u),s(n,o),s(o,d),s(e,C),s(e,c),s(c,g),s(c,k),s(c,y),s(y,w),s(e,O),s(e,D),s(D,A),s(D,F),s(D,b),s(b,E),T(B,S,U),h&&h.m(B,U),T(B,a,U),T(B,m,U),_.m(m,null)},p(B,U){U&1&&r!==(r=(B[0].serialPath||"입력되지 않음")+"")&&I(d,r),U&1&&v!==(v=B[0].baudRate+"")&&I(w,v),U&1&&p!==(p=B[0].mqttUrl+"")&&I(E,p),B[0].error?h?h.p(B,U):(h=Ce(B),h.c(),h.m(a.parentNode,a)):h&&(h.d(1),h=null),L===(L=R(B))&&_?_.p(B,U):(_.d(1),_=L(B),_&&(_.c(),_.m(m,null)))},d(B){B&&(q(e),q(S),q(a),q(m)),h&&h.d(B),_.d()}}}function Ve(t){let e;return{c(){e=i("p"),e.textContent="브리지 정보가 없습니다.",f(e,"class","empty svelte-52jy8y")},m(n,l){T(n,e,l)},p:z,d(n){n&&q(e)}}}function Xe(t){let e,n;return{c(){e=i("p"),n=N(t[2]),f(e,"class","error svelte-52jy8y")},m(l,u){T(l,e,u),s(e,n)},p(l,u){u&4&&I(n,l[2])},d(l){l&&q(e)}}}function Ge(t){let e;return{c(){e=i("p"),e.textContent="브리지 정보를 불러오는 중입니다...",f(e,"class","hint svelte-52jy8y")},m(n,l){T(n,e,l)},p:z,d(n){n&&q(e)}}}function Ce(t){let e,n,l=t[0].error+"",u;return{c(){e=i("p"),n=N("브리지 오류: "),u=N(l),f(e,"class","error subtle svelte-52jy8y")},m(o,r){T(o,e,r),s(e,n),s(e,u)},p(o,r){r&1&&l!==(l=o[0].error+"")&&I(u,l)},d(o){o&&q(e)}}}function We(t){let e=[],n=new Map,l,u=ee([...t[3]].reverse());const o=r=>r[16].receivedAt+r[16].payloadHex;for(let r=0;r<u.length;r+=1){let d=fe(t,u,r),C=o(d);n.set(C,e[r]=ye(C,d))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();l=De()},m(r,d){for(let C=0;C<e.length;C+=1)e[C]&&e[C].m(r,d);T(r,l,d)},p(r,d){d&392&&(u=ee([...r[3]].reverse()),e=qe(e,d,o,1,r,u,n,l.parentNode,He,ye,l,fe))},d(r){r&&q(l);for(let d=0;d<e.length;d+=1)e[d].d(r)}}}function Ye(t){let e;return{c(){e=i("p"),e.textContent="아직 수신된 패킷이 없습니다.",f(e,"class","empty svelte-52jy8y")},m(n,l){T(n,e,l)},p:z,d(n){n&&q(e)}}}function pe(t){let e,n=t[19]+"",l;return{c(){e=i("span"),l=N(n),f(e,"class","byte svelte-52jy8y"),f(e,"title",`byte ${t[21]}`)},m(u,o){T(u,e,o),s(e,l)},p(u,o){o&8&&n!==(n=u[19]+"")&&I(l,n)},d(u){u&&q(e)}}}function ye(t,e){let n,l,u,o=new Date(e[16].receivedAt).toLocaleTimeString()+"",r,d,C,c=e[16].topic+"",g,k,y,v=e[16].payloadLength+"",w,O,D,A,F,b,p,E=e[8](e[16].payload)+"",S,a,m,h,R,L,_=e[16].payloadHex.toUpperCase()+"",B,U,J,x,se,G,re,K=ee(e[7](e[16].payloadHex)),M=[];for(let H=0;H<K.length;H+=1)M[H]=pe(de(e,K,H));return{key:t,first:null,c(){n=i("article"),l=i("header"),u=i("span"),r=N(o),d=j(),C=i("span"),g=N(c),k=j(),y=i("span"),w=N(v),O=N(" bytes"),D=j(),A=i("div"),F=i("span"),F.textContent="ASCII",b=j(),p=i("code"),S=N(E),a=j(),m=i("div"),h=i("span"),h.textContent="HEX",R=j(),L=i("code"),B=N(_),U=j(),J=i("div"),x=i("span"),x.textContent="RS485 Bytes",se=j(),G=i("div");for(let H=0;H<M.length;H+=1)M[H].c();re=j(),f(u,"class","time"),f(C,"class","topic svelte-52jy8y"),f(y,"class","length"),f(l,"class","svelte-52jy8y"),f(F,"class","svelte-52jy8y"),f(p,"class","svelte-52jy8y"),f(A,"class","payload svelte-52jy8y"),f(h,"class","svelte-52jy8y"),f(L,"class","svelte-52jy8y"),f(m,"class","payload svelte-52jy8y"),f(x,"class","svelte-52jy8y"),f(G,"class","byte-grid svelte-52jy8y"),f(J,"class","payload bytes svelte-52jy8y"),f(n,"class","packet svelte-52jy8y"),this.first=n},m(H,$){T(H,n,$),s(n,l),s(l,u),s(u,r),s(l,d),s(l,C),s(C,g),s(l,k),s(l,y),s(y,w),s(y,O),s(n,D),s(n,A),s(A,F),s(A,b),s(A,p),s(p,S),s(n,a),s(n,m),s(m,h),s(m,R),s(m,L),s(L,B),s(n,U),s(n,J),s(J,x),s(J,se),s(J,G);for(let P=0;P<M.length;P+=1)M[P]&&M[P].m(G,null);s(n,re)},p(H,$){if(e=H,$&8&&o!==(o=new Date(e[16].receivedAt).toLocaleTimeString()+"")&&I(r,o),$&8&&c!==(c=e[16].topic+"")&&I(g,c),$&8&&v!==(v=e[16].payloadLength+"")&&I(w,v),$&8&&E!==(E=e[8](e[16].payload)+"")&&I(S,E),$&8&&_!==(_=e[16].payloadHex.toUpperCase()+"")&&I(B,_),$&136){K=ee(e[7](e[16].payloadHex));let P;for(P=0;P<K.length;P+=1){const oe=de(e,K,P);M[P]?M[P].p(oe,$):(M[P]=pe(oe),M[P].c(),M[P].m(G,null))}for(;P<M.length;P+=1)M[P].d(1);M.length=K.length}},d(H){H&&q(n),Ae(M,H)}}}function Ze(t){let e,n,l,u,o,r,d,C,c,g,k,y,v,w,O,D=(t[5]||"RS485 패킷을 기다리는 중입니다.")+"",A,F,b,p=t[1]?"정보 새로고침 중...":"정보 새로고침",E,S,a,m;function h(_,B){return _[1]&&!_[0]&&!_[2]?Ge:_[2]?Xe:_[0]?Qe:Ve}let R=h(t),L=R(t);return{c(){e=i("main"),n=i("section"),l=i("header"),u=i("div"),u.innerHTML='<p class="eyebrow svelte-52jy8y">RS485 HomeNet Bridge</p> <h1 class="svelte-52jy8y">실시간 상태</h1>',o=j(),r=i("div"),d=i("div"),C=i("span"),c=j(),g=i("span"),g.textContent=`${t[9]()}`,k=j(),y=i("div"),v=i("span"),w=j(),O=i("span"),A=N(D),F=j(),b=i("button"),E=N(p),S=j(),L.c(),f(C,"class","dot svelte-52jy8y"),f(d,"class","status svelte-52jy8y"),f(d,"data-state",t[10]()),f(v,"class","dot svelte-52jy8y"),f(y,"class","status svelte-52jy8y"),f(y,"data-state",t[4]),f(r,"class","status-column svelte-52jy8y"),f(b,"class","ghost svelte-52jy8y"),f(b,"type","button"),b.disabled=t[1],f(l,"class","viewer-header svelte-52jy8y"),f(n,"class","panel viewer svelte-52jy8y"),f(e,"class","svelte-52jy8y")},m(_,B){T(_,e,B),s(e,n),s(n,l),s(l,u),s(l,o),s(l,r),s(r,d),s(d,C),s(d,c),s(d,g),s(r,k),s(r,y),s(y,v),s(y,w),s(y,O),s(O,A),s(l,F),s(l,b),s(b,E),s(n,S),L.m(n,null),a||(m=Se(b,"click",t[11]),a=!0)},p(_,[B]){B&32&&D!==(D=(_[5]||"RS485 패킷을 기다리는 중입니다.")+"")&&I(A,D),B&16&&f(y,"data-state",_[4]),B&2&&p!==(p=_[1]?"정보 새로고침 중...":"정보 새로고침")&&I(E,p),B&2&&(b.disabled=_[1]),R===(R=h(_))&&L?L.p(_,B):(L.d(1),L=R(_),L&&(L.c(),L.m(n,null)))},i:z,o:z,d(_){_&&q(e),L.d(),a=!1,m()}}}function he(t){try{return JSON.parse(t)}catch{return null}}function xe(t,e,n){const l={idle:"브리지를 준비하는 중입니다.",starting:"시리얼 장치를 찾는 중입니다.",started:"브리지가 실행 중입니다.",error:"브리지 오류가 발생했습니다."};let u=null,o=!1,r="",d=[],C=null,c="idle",g="";Pe(()=>{k(!0)});async function k(b=!1){if(!(o&&!b)){n(1,o=!0),n(2,r="");try{const p=await fetch("/api/bridge/info");if(!p.ok){const S=await p.text();throw new Error(S||"브리지 정보를 가져오지 못했습니다.")}const E=await p.json();n(0,u=E),n(3,d=[]),y()}catch(p){n(0,u=null),v(),n(2,r=p instanceof Error?p.message:"브리지 정보를 불러오지 못했습니다.")}finally{n(1,o=!1)}}}function y(){if(typeof window>"u"||!u)return;v(),n(4,c="connecting"),n(5,g="RS485 패킷 스트림을 연결하는 중입니다...");const b=new URL("/api/packets/stream",window.location.origin);u.mqttUrl.trim().length>0&&b.searchParams.set("mqttUrl",u.mqttUrl.trim()),C=new EventSource(b.toString());const p=S=>{const a=he(S.data);if(!a)return;const m=a.state;m==="connected"?(n(4,c="connected"),n(5,g="패킷 스트림 연결 완료")):m==="subscribed"?(n(4,c="connected"),n(5,g=`'${a.topic}' 패킷 수신 중`)):m==="error"?(n(4,c="error"),n(5,g=typeof a.message=="string"?a.message:"패킷 스트림 오류가 발생했습니다.")):m==="connecting"&&(n(4,c="connecting"),n(5,g="패킷 스트림을 다시 연결하는 중입니다..."))},E=S=>{const a=he(S.data);a&&n(3,d=[...d,a].slice(-100))};C.addEventListener("status",p),C.addEventListener("packet",E),C.onerror=()=>{n(4,c="error"),n(5,g="스트림 연결이 끊어졌습니다. 잠시 후 다시 시도하세요.")}}function v(){C&&(C.close(),C=null),n(4,c="idle"),n(5,g="")}const w=b=>{var p;return((p=b.match(/.{1,2}/g))==null?void 0:p.map(E=>E.toUpperCase()))??[]},O=b=>b.split("").map(p=>{const E=p.charCodeAt(0);return E>=32&&E<=126?p:p===`
`?"⏎":p==="\r"?"↵":p==="	"?"⇥":"·"}).join(""),D=()=>o?"브리지 정보를 불러오는 중입니다...":r||(u?l[u.status]:"브리지 정보가 없습니다."),A=()=>r?"error":(u==null?void 0:u.status)??"idle";return Ne(v),[u,o,r,d,c,g,k,w,O,D,A,()=>k(!0)]}class et extends Je{constructor(e){super(),ze(this,e,xe,Ze,ke,{})}}const be=document.getElementById("app");if(!be)throw new Error("Failed to find app element");new et({target:be});
